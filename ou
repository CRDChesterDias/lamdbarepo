def append_df_to_excel(filename, df, sheet_name):
    if not os.path.exists(filename):
        # File doesn't exist, create new workbook
        with pd.ExcelWriter(filename, engine='openpyxl') as writer:
            df.to_excel(writer, sheet_name=sheet_name, index=False)
    else:
        # Append to existing sheet
        book = load_workbook(filename)
        if sheet_name in book.sheetnames:
            startrow = book[sheet_name].max_row
        else:
            startrow = 0

        with pd.ExcelWriter(filename, engine='openpyxl', mode='a', if_sheet_exists='overlay') as writer:
            writer.book = book
            writer.sheets = {ws.title: ws for ws in book.worksheets}
            df.to_excel(writer, sheet_name=sheet_name, index=False, header=startrow == 0, startrow=startrow)
