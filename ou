 else:
                    orig_row = min(r_idx + 1, original_ws.max_row)
                    orig_col = min(c_idx, original_ws.max_column)
                    if original_ws.cell(row=orig_row, column=orig_col).has_style:
                        ws.cell(row=r_idx, column=c_idx)._style = copy(original_ws.cell(row=orig_row, column=orig_col)._style)

    # Step 6: Add II_with_matches
    ws_ii = new_wb.create_sheet("II_with_matches")
    write_df_with_styles(ws_ii, ii_data, source_ws)

    # Step 7: Add Remaining_EM
    ws_em = new_wb.create_sheet("Remaining_EM")
    write_df_with_styles(ws_em, em_data, source_ws)

    # Step 8: Save
    new_wb.save("ABCAEDEA_processed.xlsx")
